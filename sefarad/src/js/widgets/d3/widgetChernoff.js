// New widget
var widgetChernoff = {
	// Widget name.
	name: "Chernoff Faces",
	// Widget description.
	description: "Display the data in the shape of human face.",
	// Path to the image of the widget.
	img: "img/widgets/chernoff_widget.png",
	// Type of the widget.
	type: "chernoffWidget",
	// Help display on the widget
	help_en: "Chernoff faces show the sentiment of an entity with a face representation. The anger the face, the worse the sentiment.",
	help_es: "Ayuda",
	// [OPTIONAL] data taken from this field.
	// field: "polarityValue",
	// Category of the widget (1: textFilter, 2: numericFilter, 3: graph, 5:results)
	cat: 3,


	render: function () {
		var id = 'A' + Math.floor(Math.random() * 10001);
		var field = widgetChernoff.field || "";
		vm.activeWidgetsRight.push({"id":ko.observable(id),
									"title": ko.observable(widgetChernoff.name), 
									"type": ko.observable(widgetChernoff.type), 
									"help_en": ko.observable(widgetChernoff.help_en), 
									"help_es": ko.observable(widgetChernoff.help_es),
									"field": ko.observable(widgetChernoff.field),
									"collapsed": ko.observable(false), 
									"showWidgetHelp":ko.observable(false)});

		widgetChernoff.paint(id);
	},

	options: {

	},


	paint: function (id) {

		$('#' + id).empty();	

		if (vm.filteredData().length != Manager.response.response.numFound) {
			return;
		}

		valoresSeleccionados = []
		$.each(vm.activeWidgets(), function (index, item) {
			if (item.type() == 'tagcloud' && item.field() == 'entity') {
				for (var i = 0; i < item.values().length; i++) {
					if (item.values()[i]['state']()) {
						valoresSeleccionados.push(item.values()[i]['name']())
					}
				}
			}
		});

		if (valoresSeleccionados.length == 0) {
			$('#'+id).append('<div id="tooltip"></div>');
			$("#" + id + " > #tooltip").append("No hay entidades seleccionadas.");
			return;
		}

		entityData = {
				'Apple': {f: 0, h: 0.1724, m: 0, nw: 0.7647, nh: 0.7647, ew: -0.0588, eh: 0.0588, b: 0},
				'Amazon': {f: 0, h: -0.7857, m: 0, nw: 1, nh: 1, ew: -0.3333, eh: 0.3333, b: 0},
				'Google': {f: 0, h: -0.0256, m: 0, nw: 0.5789, nh: 0.5789, ew: 0.0526, eh: -0.0526, b: 0},
				'Vodafone': {f: 0, h: 0.3974, m: 0, nw: 0.4686, nh: 0.4686, ew: -0.4324, eh: -0.2153, b: 0},
				'Santander': {f: 0, h: -0.0357, m: 0, nw: 0.8518, nh: 0.8518, ew: -0.8518, eh: -0.7037, b: 0},
				'Telefonica': {f: 0, h: 0.8122, m: 0, nw: 0.8446, nh: 0.8446, ew: 0.1399, eh: 0.8912, b: 0},
				'Iberdrola': {f: 0, h: 0.5769, m: 0, nw: 0.2683, nh: 0.2683, ew: -0.4634, eh: -0.9512, b: 0}
				}

		dat = []
		for (var i = 0; i < valoresSeleccionados.length; i++) {
			dat.push(entityData[valoresSeleccionados[i]])
		}

		var c = d3.chernoff()
			.face(function(d) { return d.f; })
			.hair(function(d) { return d.h; })
			.mouth(function(d) { return d.m; })
			.nosew(function(d) { return d.nw; })
			.noseh(function(d) { return d.nh; })
			.eyew(function(d) { return d.ew; })
			.eyeh(function(d) { return d.eh; })
			.brow(function(d) { return d.b; });

		var inline;
		if ($('#' + id).width() > 700) {
			inline = 4;
		} else {
			inline = 2;
		}
		console.log('inline: ' + inline)
		var margin = {top: 10, right: 40, bottom:10, left: 40},
			width = $('#'+id).width() - margin.left - margin.right,
			height = 200 * Math.ceil(valoresSeleccionados.length/inline) - margin.top - margin.bottom;

		var svg = d3.select('#'+id).append("svg")
			.attr("width", width + margin.left + margin.right)
			.attr("height", height + margin.top + margin.bottom);

		// for (var i = 0; i < valoresSeleccionados[i].length; i++) {

		// }

		// dat = [
		// 	{f: 0, h: -1, m: -1, nw: 0.3, nh: 0.3, ew: 0.3, eh: 0.3, b: -1},
		// 	{f: 0.5, h: 0, m: 0, nw: 0.3, nh: 1, ew: 1, eh: 0.3, b: 0},
		// 	{f: 1, h: 1, m: 1, nw: 1, nh: 0.3, ew: 0.3, eh: 1, b: 1}];


		separation = 20;

		svg.selectAll("g.chernoff").data(dat).enter()
			.append("svg:g")
			.attr("class", "chernoff")
			.attr("transform", function(d, i) {
				size = ($('#'+id).width() - margin.left - margin.right)/inline;
				console.log(size);
				return "translate(" + (((i%inline)*size)+margin.left) + "," + (Math.floor(i/inline)*200) + ")";
			})
			.call(c);

		for (var i = 0; i < valoresSeleccionados.length; i++) {
		
			size = ($('#'+id).width() - margin.left - margin.right)/inline;
			console.log(valoresSeleccionados[i])
			svg.append("text")
				.text(valoresSeleccionados[i])
				.attr("x", (((i%inline)*size)+margin.left) + 70)
				.attr("y", (Math.floor(i/inline)*200 + 200))
				.attr("font-family", "sans-serif")
				.attr("font-size", "20px")
				.attr("text-anchor", "middle")
		}

		// svg.append("text")
		// 	.text(valoresSeleccionados)
		// 	.attr("translate(" + (((i%inline)*size)+margin.left) + "," + (Math.floor(i/inline)*200) + ")")
		// 	.attr("font-family", "sans-serif")
		// 	.attr("font-size", "20px")
		// 	.attr("text-anchor", "middle")

		return;


		// // d3.select('#'+id).select('svg').remove();
		// // d3.select('#'+id).select('#tooltip').remove();

		// /*
		// *	Creamos los checks.
		// */

		// $('#'+id).append("<div></div>")
		// $('#' + id + ' > div').addClass('widget-configuration');

		// for (key in Manager.response.facet_counts.facet_fields.entity) {
		// 	$('#' + id + ' > div').append('<input type="radio" name="group' + id + '" value="' + key + '">' + key + '</input>')
		// }

		// valorSeleccionado = stockWidget.options[id];
		// // console.log(valorSeleccionado);

		// $('input:radio').on('change', function(){
		// 	valorSeleccionado = $('input:radio[name=group' + id + ']:checked').val();
		// 	stockWidget.options[id] = valorSeleccionado;
		// 	stockWidget.paint(id)
		// });

		// if (stockWidget.options[id] != undefined) {
		// 	$('#'+id).append('<div id="tooltip">' + stockWidget.options[id].toUpperCase() + '</div>');
		// 	$('input[name="group' + id + '"][value="' + stockWidget.options[id] + '"]').prop('checked', true);
		// } else {
		// 	$('#'+id).append('<div id="tooltip"></div>');
		// 	$("#" + id + " > #tooltip").append("No hay entidades seleccionadas.");
		// 	return;
		// }
		valoresSeleccionados = []
		$.each(vm.activeWidgets(), function (index, item) {
			if (item.type() == 'tagcloud' && item.field() == 'entity') {
				for (var i = 0; i < item.values().length; i++) {
					if (item.values()[i]['state']()) {
						valoresSeleccionados.push(item.values()[i]['name']())
					}
				}
			}
		});

		if (valoresSeleccionados.length == 0) {
			$('#'+id).append('<div id="tooltip"></div>');
			$("#" + id + " > #tooltip").append("No hay entidades seleccionadas.");
			return;
		}

		// console.log(valoresSeleccionados)

		sentimentValue = {}

		for (var i = 0; i < vm.filteredData().length; i++) {
			for (var j = 0; j < valoresSeleccionados.length; j++) {
				if (vm.filteredData()[i].entity() == valoresSeleccionados[j]) {
					fecha = vm.filteredData()[i].created()[0].substring(0, 10);
					if (sentimentValue[vm.filteredData()[i].entity()] == undefined) {
						sentimentValue[vm.filteredData()[i].entity()] = new Object()
					}
					sentimentValue[vm.filteredData()[i].entity()][fecha] = parseFloat(vm.filteredData()[i].polarityValue()[0]);
				}
			}
		}
		console.log(sentimentValue);

		// Datos historicos
		var historicos = {
			'fcc': [["2012-01-02", 20.11], ["2012-01-03", 20.3], ["2012-01-04", 19.95], ["2012-01-05", 19.33], ["2012-01-06", 19.0], ["2012-01-09", 18.93], ["2012-01-10", 18.88], ["2012-01-11", 19.05], ["2012-01-12", 19.41], ["2012-01-13", 19.12], ["2012-01-16", 19.02], ["2012-01-17", 18.81], ["2012-01-18", 18.73], ["2012-01-19", 19.49], ["2012-01-20", 18.88], ["2012-01-23", 19.12], ["2012-01-24", 18.66], ["2012-01-25", 18.58], ["2012-01-26", 18.83], ["2012-01-27", 18.3], ["2012-01-30", 17.91], ["2012-01-31", 17.97], ["2012-02-01", 18.33], ["2012-02-02", 18.64], ["2012-02-03", 18.85], ["2012-02-06", 18.92], ["2012-02-07", 18.73], ["2012-02-08", 18.98], ["2012-02-09", 18.89], ["2012-02-10", 18.74], ["2012-02-13", 18.69], ["2012-02-14", 18.47], ["2012-02-15", 18.16], ["2012-02-16", 17.75], ["2012-02-17", 18.09], ["2012-02-20", 18.57], ["2012-02-21", 18.42], ["2012-02-22", 20.18], ["2012-02-23", 19.96], ["2012-02-24", 19.55], ["2012-02-27", 19.49], ["2012-02-28", 19.22], ["2012-02-29", 19.02], ["2012-03-01", 18.67], ["2012-03-02", 18.42], ["2012-03-05", 18.06], ["2012-03-06", 17.55], ["2012-03-07", 17.44], ["2012-03-08", 17.16], ["2012-03-09", 17.76], ["2012-03-12", 17.5], ["2012-03-13", 17.36], ["2012-03-14", 17.6], ["2012-03-15", 17.9], ["2012-03-16", 17.94], ["2012-03-19", 18.06], ["2012-03-20", 17.91], ["2012-03-21", 17.85], ["2012-03-22", 17.24], ["2012-03-23", 17.22], ["2012-03-26", 17.12], ["2012-03-27", 17.15], ["2012-03-28", 16.6], ["2012-03-29", 16.44], ["2012-03-30", 16.75], ["2012-04-02", 16.74], ["2012-04-03", 16.19], ["2012-04-04", 15.65], ["2012-04-05", 15.68], ["2012-04-06", 15.68], ["2012-04-09", 15.68], ["2012-04-10", 15.09], ["2012-04-11", 15.3], ["2012-04-12", 14.79], ["2012-04-13", 14.02], ["2012-04-16", 13.73], ["2012-04-17", 14.26], ["2012-04-18", 13.38], ["2012-04-19", 13.01], ["2012-04-20", 13.09], ["2012-04-23", 12.15], ["2012-04-24", 12.51], ["2012-04-25", 13.44], ["2012-04-26", 12.9], ["2012-04-27", 13.4], ["2012-04-30", 12.9], ["2012-05-01", 12.9], ["2012-05-02", 12.4], ["2012-05-03", 12.36], ["2012-05-04", 12.14], ["2012-05-07", 12.73], ["2012-05-08", 12.6], ["2012-05-09", 12.24], ["2012-05-10", 12.57], ["2012-05-11", 11.95], ["2012-05-14", 11.23], ["2012-05-15", 10.82], ["2012-05-16", 10.59], ["2012-05-17", 11.19], ["2012-05-18", 11.57], ["2012-05-21", 11.64], ["2012-05-22", 11.66], ["2012-05-23", 10.69], ["2012-05-24", 10.73], ["2012-05-25", 10.85], ["2012-05-28", 10.53], ["2012-05-29", 10.26], ["2012-05-30", 9.99], ["2012-05-31", 10.19], ["2012-06-01", 9.5], ["2012-06-04", 9.44], ["2012-06-05", 9.8], ["2012-06-06", 9.71], ["2012-06-07", 9.99], ["2012-06-08", 10.15], ["2012-06-11", 9.8], ["2012-06-12", 9.61], ["2012-06-13", 9.26], ["2012-06-14", 9.53], ["2012-06-15", 9.91], ["2012-06-18", 9.5], ["2012-06-19", 9.45], ["2012-06-20", 9.67], ["2012-06-21", 9.42], ["2012-06-22", 9.84], ["2012-06-25", 9.44], ["2012-06-26", 9.02], ["2012-06-27", 9.28], ["2012-06-28", 9.3], ["2012-06-29", 10.08], ["2012-07-02", 10.3], ["2012-07-03", 10.76], ["2012-07-04", 10.78], ["2012-07-05", 10.47], ["2012-07-06", 9.84], ["2012-07-09", 9.89], ["2012-07-10", 10.06], ["2012-07-11", 10.06], ["2012-07-12", 9.93], ["2012-07-13", 9.45], ["2012-07-16", 8.72], ["2012-07-17", 8.37], ["2012-07-18", 8.39], ["2012-07-19", 8.78], ["2012-07-20", 7.97], ["2012-07-23", 7.69], ["2012-07-24", 7.15], ["2012-07-25", 7.39], ["2012-07-26", 7.91], ["2012-07-27", 8.23], ["2012-07-30", 8.19], ["2012-07-31", 8.29], ["2012-08-01", 8.11], ["2012-08-02", 7.41], ["2012-08-03", 7.78], ["2012-08-06", 8.29], ["2012-08-07", 8.37], ["2012-08-08", 8.22], ["2012-08-09", 8.22], ["2012-08-10", 8.2], ["2012-08-13", 8.1], ["2012-08-14", 8.17], ["2012-08-15", 8.2], ["2012-08-16", 9.27], ["2012-08-17", 10.28], ["2012-08-20", 10.41], ["2012-08-21", 10.33], ["2012-08-22", 9.86], ["2012-08-23", 10.1], ["2012-08-24", 9.89], ["2012-08-27", 10.22], ["2012-08-28", 9.91], ["2012-08-29", 9.89], ["2012-08-30", 9.9], ["2012-08-31", 10.0], ["2012-09-03", 9.9], ["2012-09-04", 9.94], ["2012-09-05", 9.68], ["2012-09-06", 10.18], ["2012-09-07", 10.26], ["2012-09-10", 10.49], ["2012-09-11", 10.56], ["2012-09-12", 10.64], ["2012-09-13", 10.52], ["2012-09-14", 11.22], ["2012-09-17", 11.73], ["2012-09-18", 11.75], ["2012-09-19", 11.82], ["2012-09-20", 11.52], ["2012-09-21", 11.95], ["2012-09-24", 11.76], ["2012-09-25", 11.41], ["2012-09-26", 10.38], ["2012-09-27", 10.31], ["2012-09-28", 10.15], ["2012-10-01", 10.42], ["2012-10-02", 10.46], ["2012-10-03", 10.3], ["2012-10-04", 10.33], ["2012-10-05", 10.3], ["2012-10-08", 10.07], ["2012-10-09", 10.09], ["2012-10-10", 9.88], ["2012-10-11", 10.05], ["2012-10-12", 9.85], ["2012-10-15", 9.64], ["2012-10-16", 9.81], ["2012-10-17", 10.52], ["2012-10-18", 10.22], ["2012-10-19", 10.3], ["2012-10-22", 10.23], ["2012-10-23", 10.14], ["2012-10-24", 9.98], ["2012-10-25", 9.95], ["2012-10-26", 9.92], ["2012-10-29", 9.65], ["2012-10-30", 9.81], ["2012-10-31", 10.08], ["2012-11-01", 10.15], ["2012-11-02", 10.45], ["2012-11-05", 10.06], ["2012-11-06", 10.08], ["2012-11-07", 9.88], ["2012-11-08", 9.73], ["2012-11-09", 9.75], ["2012-11-12", 9.54], ["2012-11-13", 9.41], ["2012-11-14", 8.98], ["2012-11-15", 8.84], ["2012-11-16", 8.52], ["2012-11-19", 8.83], ["2012-11-20", 8.75], ["2012-11-21", 8.92], ["2012-11-22", 9.0], ["2012-11-23", 9.15], ["2012-11-26", 8.97], ["2012-11-27", 8.98], ["2012-11-28", 8.84], ["2012-11-29", 9.17], ["2012-11-30", 9.14], ["2012-12-03", 9.08], ["2012-12-04", 9.03], ["2012-12-05", 9.19], ["2012-12-06", 9.12], ["2012-12-07", 9.16], ["2012-12-10", 9.1], ["2012-12-11", 9.44], ["2012-12-12", 9.55], ["2012-12-13", 9.46], ["2012-12-14", 9.49], ["2012-12-17", 10.22], ["2012-12-18", 10.54], ["2012-12-19", 10.49], ["2012-12-20", 10.63], ["2012-12-21", 10.15], ["2012-12-24", 9.83], ["2012-12-25", 9.83], ["2012-12-26", 9.83], ["2012-12-27", 9.62], ["2012-12-28", 9.32], ["2012-12-31", 9.37]],
			'bankia': [["2012-01-02", 359.9], ["2012-01-03", 357.0], ["2012-01-04", 358.2], ["2012-01-05", 351.1], ["2012-01-06", 356.8], ["2012-01-09", 355.2], ["2012-01-10", 355.0], ["2012-01-11", 357.1], ["2012-01-12", 354.3], ["2012-01-13", 357.0], ["2012-01-16", 358.5], ["2012-01-17", 362.4], ["2012-01-18", 356.8], ["2012-01-19", 360.5], ["2012-01-20", 355.0], ["2012-01-23", 357.2], ["2012-01-24", 358.0], ["2012-01-25", 355.0], ["2012-01-26", 354.4], ["2012-01-27", 350.0], ["2012-01-30", 345.7], ["2012-01-31", 346.6], ["2012-02-01", 356.4], ["2012-02-02", 356.0], ["2012-02-03", 355.0], ["2012-02-06", 351.6], ["2012-02-07", 353.5], ["2012-02-08", 354.3], ["2012-02-09", 356.1], ["2012-02-10", 352.5], ["2012-02-13", 348.8], ["2012-02-14", 345.0], ["2012-02-15", 333.7], ["2012-02-16", 309.4], ["2012-02-17", 307.5], ["2012-02-20", 310.0], ["2012-02-21", 308.1], ["2012-02-22", 305.0], ["2012-02-23", 305.0], ["2012-02-24", 305.0], ["2012-02-27", 303.3], ["2012-02-28", 304.0], ["2012-02-29", 303.6], ["2012-03-01", 303.0], ["2012-03-02", 303.5], ["2012-03-05", 303.0], ["2012-03-06", 300.0], ["2012-03-07", 300.0], ["2012-03-08", 300.0], ["2012-03-09", 301.0], ["2012-03-12", 300.0], ["2012-03-13", 295.5], ["2012-03-14", 296.8], ["2012-03-15", 294.4], ["2012-03-16", 295.3], ["2012-03-19", 300.5], ["2012-03-20", 300.6], ["2012-03-21", 295.0], ["2012-03-22", 293.9], ["2012-03-23", 292.3], ["2012-03-26", 291.1], ["2012-03-27", 285.5], ["2012-03-28", 275.2], ["2012-03-29", 270.0], ["2012-03-30", 271.6], ["2012-04-02", 276.0], ["2012-04-03", 268.0], ["2012-04-04", 256.2], ["2012-04-05", 256.6], ["2012-04-06", 256.6], ["2012-04-09", 256.6], ["2012-04-10", 250.0], ["2012-04-11", 253.0], ["2012-04-12", 262.8], ["2012-04-13", 254.4], ["2012-04-16", 255.0], ["2012-04-17", 261.0], ["2012-04-18", 258.3], ["2012-04-19", 254.1], ["2012-04-20", 254.7], ["2012-04-23", 248.4], ["2012-04-24", 252.4], ["2012-04-25", 253.7], ["2012-04-26", 254.3], ["2012-04-27", 259.0], ["2012-04-30", 259.3], ["2012-05-01", 259.3], ["2012-05-02", 246.0], ["2012-05-03", 246.4], ["2012-05-04", 245.5], ["2012-05-07", 237.5], ["2012-05-08", 226.2], ["2012-05-09", 213.0], ["2012-05-10", 210.5], ["2012-05-11", 207.1], ["2012-05-14", 188.6], ["2012-05-15", 186.2], ["2012-05-16", 165.5], ["2012-05-17", 142.2], ["2012-05-18", 175.6], ["2012-05-21", 176.3], ["2012-05-22", 172.0], ["2012-05-23", 169.6], ["2012-05-24", 157.0], ["2012-05-25", 157.0], ["2012-05-28", 136.0], ["2012-05-29", 113.9], ["2012-05-30", 104.1], ["2012-05-31", 104.3], ["2012-06-01", 102.0], ["2012-06-04", 101.5], ["2012-06-05", 101.7], ["2012-06-06", 104.0], ["2012-06-07", 102.4], ["2012-06-08", 102.9], ["2012-06-11", 104.8], ["2012-06-12", 102.8], ["2012-06-13", 101.5], ["2012-06-14", 98.4], ["2012-06-15", 92.0], ["2012-06-18", 83.7], ["2012-06-19", 80.8], ["2012-06-20", 84.0], ["2012-06-21", 92.2], ["2012-06-22", 97.0], ["2012-06-25", 95.9], ["2012-06-26", 87.6], ["2012-06-27", 93.6], ["2012-06-28", 90.0], ["2012-06-29", 92.4], ["2012-07-02", 94.5], ["2012-07-03", 91.3], ["2012-07-04", 93.2], ["2012-07-05", 90.8], ["2012-07-06", 84.9], ["2012-07-09", 83.4], ["2012-07-10", 83.7], ["2012-07-11", 77.2], ["2012-07-12", 70.0], ["2012-07-13", 65.1], ["2012-07-16", 61.1], ["2012-07-17", 52.9], ["2012-07-18", 60.5], ["2012-07-19", 69.0], ["2012-07-20", 61.8], ["2012-07-23", 66.5], ["2012-07-24", 67.0], ["2012-07-25", 66.5], ["2012-07-26", 68.4], ["2012-07-27", 69.6], ["2012-07-30", 73.6], ["2012-07-31", 79.8], ["2012-08-01", 85.1], ["2012-08-02", 89.1], ["2012-08-03", 92.4], ["2012-08-06", 95.3], ["2012-08-07", 101.9], ["2012-08-08", 126.8], ["2012-08-09", 151.3], ["2012-08-10", 121.3], ["2012-08-13", 101.8], ["2012-08-14", 113.0], ["2012-08-15", 120.2], ["2012-08-16", 140.1], ["2012-08-17", 147.0], ["2012-08-20", 140.2], ["2012-08-21", 139.5], ["2012-08-22", 135.9], ["2012-08-23", 133.1], ["2012-08-24", 126.0], ["2012-08-27", 122.1], ["2012-08-28", 117.0], ["2012-08-29", 135.9], ["2012-08-30", 134.2], ["2012-08-31", 142.6], ["2012-09-03", 137.0], ["2012-09-04", 141.0], ["2012-09-05", 139.1], ["2012-09-06", 137.7], ["2012-09-07", 135.0], ["2012-09-10", 131.0], ["2012-09-11", 138.8], ["2012-09-12", 137.3], ["2012-09-13", 137.9], ["2012-09-14", 140.2], ["2012-09-17", 138.6], ["2012-09-18", 141.0], ["2012-09-19", 138.5], ["2012-09-20", 136.2], ["2012-09-21", 144.0], ["2012-09-24", 143.0], ["2012-09-25", 143.0], ["2012-09-26", 135.7], ["2012-09-27", 132.0], ["2012-09-28", 130.0], ["2012-10-01", 129.0], ["2012-10-02", 128.3], ["2012-10-03", 125.3], ["2012-10-04", 121.0], ["2012-10-05", 117.5], ["2012-10-08", 108.7], ["2012-10-09", 98.1], ["2012-10-10", 102.0], ["2012-10-11", 101.7], ["2012-10-12", 98.2], ["2012-10-15", 102.0], ["2012-10-16", 104.1], ["2012-10-17", 123.8], ["2012-10-18", 128.0], ["2012-10-19", 110.3], ["2012-10-22", 116.1], ["2012-10-23", 118.8], ["2012-10-24", 117.8], ["2012-10-25", 117.0], ["2012-10-26", 114.0], ["2012-10-29", 110.0], ["2012-10-30", 115.3], ["2012-10-31", 116.0], ["2012-11-01", 116.3], ["2012-11-02", 120.0], ["2012-11-05", 115.2], ["2012-11-06", 113.9], ["2012-11-07", 110.1], ["2012-11-08", 108.1], ["2012-11-09", 105.0], ["2012-11-12", 102.3], ["2012-11-13", 102.4], ["2012-11-14", 101.0], ["2012-11-15", 102.4], ["2012-11-16", 101.0], ["2012-11-19", 102.7], ["2012-11-20", 102.6], ["2012-11-21", 101.0], ["2012-11-22", 101.8], ["2012-11-23", 101.3], ["2012-11-26", 101.0], ["2012-11-27", 106.0], ["2012-11-28", 96.1], ["2012-11-29", 96.0], ["2012-11-30", 71.7], ["2012-12-03", 66.9], ["2012-12-04", 71.2], ["2012-12-05", 72.9], ["2012-12-06", 71.0], ["2012-12-07", 67.5], ["2012-12-10", 65.7], ["2012-12-11", 68.3], ["2012-12-12", 70.9], ["2012-12-13", 70.0], ["2012-12-14", 69.0], ["2012-12-17", 69.0], ["2012-12-18", 69.5], ["2012-12-19", 69.7], ["2012-12-20", 69.2], ["2012-12-21", 67.5], ["2012-12-24", 68.6], ["2012-12-25", 68.6], ["2012-12-26", 68.6], ["2012-12-27", 55.2], ["2012-12-28", 40.4], ["2012-12-31", 39.1]], 
			'bankinter': [["2012-01-02", 4.84], ["2012-01-03", 4.81], ["2012-01-04", 4.8], ["2012-01-05", 4.55], ["2012-01-06", 4.56], ["2012-01-09", 4.63], ["2012-01-10", 4.76], ["2012-01-11", 4.75], ["2012-01-12", 4.84], ["2012-01-13", 4.86], ["2012-01-16", 4.84], ["2012-01-17", 4.92], ["2012-01-18", 4.88], ["2012-01-19", 5.21], ["2012-01-20", 5.2], ["2012-01-23", 5.22], ["2012-01-24", 5.2], ["2012-01-25", 5.25], ["2012-01-26", 5.3], ["2012-01-27", 5.25], ["2012-01-30", 5.12], ["2012-01-31", 5.12], ["2012-02-01", 5.29], ["2012-02-02", 5.3], ["2012-02-03", 5.33], ["2012-02-06", 5.37], ["2012-02-07", 5.34], ["2012-02-08", 5.37], ["2012-02-09", 5.28], ["2012-02-10", 5.19], ["2012-02-13", 5.13], ["2012-02-14", 5.15], ["2012-02-15", 5.17], ["2012-02-16", 5.0], ["2012-02-17", 5.0], ["2012-02-20", 5.09], ["2012-02-21", 5.1], ["2012-02-22", 4.98], ["2012-02-23", 4.97], ["2012-02-24", 4.97], ["2012-02-27", 4.95], ["2012-02-28", 4.72], ["2012-02-29", 4.64], ["2012-03-01", 4.63], ["2012-03-02", 4.64], ["2012-03-05", 4.58], ["2012-03-06", 4.41], ["2012-03-07", 4.47], ["2012-03-08", 4.54], ["2012-03-09", 4.49], ["2012-03-12", 4.45], ["2012-03-13", 4.51], ["2012-03-14", 4.71], ["2012-03-15", 4.79], ["2012-03-16", 4.74], ["2012-03-19", 4.78], ["2012-03-20", 4.77], ["2012-03-21", 4.74], ["2012-03-22", 4.56], ["2012-03-23", 4.5], ["2012-03-26", 4.35], ["2012-03-27", 4.22], ["2012-03-28", 4.06], ["2012-03-29", 3.98], ["2012-03-30", 3.93], ["2012-04-02", 3.92], ["2012-04-03", 3.69], ["2012-04-04", 3.57], ["2012-04-05", 3.54], ["2012-04-06", 3.54], ["2012-04-09", 3.54], ["2012-04-10", 3.35], ["2012-04-11", 3.51], ["2012-04-12", 3.49], ["2012-04-13", 3.29], ["2012-04-16", 3.24], ["2012-04-17", 3.4], ["2012-04-18", 3.17], ["2012-04-19", 3.1], ["2012-04-20", 3.16], ["2012-04-23", 3.05], ["2012-04-24", 3.12], ["2012-04-25", 3.33], ["2012-04-26", 3.25], ["2012-04-27", 3.45], ["2012-04-30", 3.36], ["2012-05-01", 3.36], ["2012-05-02", 3.22], ["2012-05-03", 3.21], ["2012-05-04", 3.27], ["2012-05-07", 3.42], ["2012-05-08", 3.42], ["2012-05-09", 3.23], ["2012-05-10", 3.42], ["2012-05-11", 3.42], ["2012-05-14", 3.3], ["2012-05-15", 3.25], ["2012-05-16", 3.09], ["2012-05-17", 2.96], ["2012-05-18", 3.03], ["2012-05-21", 3.01], ["2012-05-22", 3.05], ["2012-05-23", 2.94], ["2012-05-24", 2.96], ["2012-05-25", 2.93], ["2012-05-28", 2.81], ["2012-05-29", 2.69], ["2012-05-30", 2.63], ["2012-05-31", 2.47], ["2012-06-01", 2.42], ["2012-06-04", 2.47], ["2012-06-05", 2.53], ["2012-06-06", 2.45], ["2012-06-07", 2.41], ["2012-06-08", 2.49], ["2012-06-11", 2.5], ["2012-06-12", 2.38], ["2012-06-13", 2.4], ["2012-06-14", 2.51], ["2012-06-15", 2.49], ["2012-06-18", 2.38], ["2012-06-19", 2.45], ["2012-06-20", 2.48], ["2012-06-21", 2.57], ["2012-06-22", 2.75], ["2012-06-25", 2.6], ["2012-06-26", 2.49], ["2012-06-27", 2.5], ["2012-06-28", 2.54], ["2012-06-29", 2.72], ["2012-07-02", 2.72], ["2012-07-03", 2.72], ["2012-07-04", 2.71], ["2012-07-05", 2.6], ["2012-07-06", 2.5], ["2012-07-09", 2.42], ["2012-07-10", 2.48], ["2012-07-11", 2.54], ["2012-07-12", 2.52], ["2012-07-13", 2.48], ["2012-07-16", 2.42], ["2012-07-17", 2.41], ["2012-07-18", 2.45], ["2012-07-19", 2.43], ["2012-07-20", 2.26], ["2012-07-23", 2.23], ["2012-07-24", 2.11], ["2012-07-25", 2.1], ["2012-07-26", 2.39], ["2012-07-27", 2.42], ["2012-07-30", 2.53], ["2012-07-31", 2.63], ["2012-08-01", 2.55], ["2012-08-02", 2.41], ["2012-08-03", 2.53], ["2012-08-06", 2.69], ["2012-08-07", 2.71], ["2012-08-08", 2.72], ["2012-08-09", 2.75], ["2012-08-10", 2.79], ["2012-08-13", 2.78], ["2012-08-14", 2.81], ["2012-08-15", 2.8], ["2012-08-16", 3.01], ["2012-08-17", 3.07], ["2012-08-20", 3.0], ["2012-08-21", 3.01], ["2012-08-22", 2.92], ["2012-08-23", 2.91], ["2012-08-24", 2.87], ["2012-08-27", 2.9], ["2012-08-28", 2.87], ["2012-08-29", 2.85], ["2012-08-30", 2.86], ["2012-08-31", 2.99], ["2012-09-03", 2.95], ["2012-09-04", 2.98], ["2012-09-05", 2.99], ["2012-09-06", 3.16], ["2012-09-07", 3.18], ["2012-09-10", 3.23], ["2012-09-11", 3.38], ["2012-09-12", 3.39], ["2012-09-13", 3.37], ["2012-09-14", 3.42], ["2012-09-17", 3.41], ["2012-09-18", 3.34], ["2012-09-19", 3.37], ["2012-09-20", 3.28], ["2012-09-21", 3.4], ["2012-09-24", 3.3], ["2012-09-25", 3.36], ["2012-09-26", 3.24], ["2012-09-27", 3.22], ["2012-09-28", 3.38], ["2012-10-01", 3.31], ["2012-10-02", 3.3], ["2012-10-03", 3.28], ["2012-10-04", 3.27], ["2012-10-05", 3.29], ["2012-10-08", 3.28], ["2012-10-09", 3.18], ["2012-10-10", 2.99], ["2012-10-11", 3.01], ["2012-10-12", 2.94], ["2012-10-15", 2.91], ["2012-10-16", 3.12], ["2012-10-17", 3.29], ["2012-10-18", 3.21], ["2012-10-19", 3.04], ["2012-10-22", 3.06], ["2012-10-23", 3.06], ["2012-10-24", 3.07], ["2012-10-25", 3.1], ["2012-10-26", 3.09], ["2012-10-29", 3.08], ["2012-10-30", 3.07], ["2012-10-31", 3.05], ["2012-11-01", 3.07], ["2012-11-02", 3.1], ["2012-11-05", 3.05], ["2012-11-06", 3.04], ["2012-11-07", 3.07], ["2012-11-08", 3.05], ["2012-11-09", 2.98], ["2012-11-12", 3.02], ["2012-11-13", 3.02], ["2012-11-14", 2.98], ["2012-11-15", 2.99], ["2012-11-16", 2.92], ["2012-11-19", 2.96], ["2012-11-20", 2.93], ["2012-11-21", 2.94], ["2012-11-22", 2.96], ["2012-11-23", 2.93], ["2012-11-26", 2.95], ["2012-11-27", 2.95], ["2012-11-28", 2.92], ["2012-11-29", 3.06], ["2012-11-30", 3.06], ["2012-12-03", 3.04], ["2012-12-04", 3.04], ["2012-12-05", 3.11], ["2012-12-06", 3.05], ["2012-12-07", 3.03], ["2012-12-10", 3.0], ["2012-12-11", 2.93], ["2012-12-12", 3.01], ["2012-12-13", 3.02], ["2012-12-14", 3.0], ["2012-12-17", 3.1], ["2012-12-18", 3.2], ["2012-12-19", 3.35], ["2012-12-20", 3.34], ["2012-12-21", 3.31], ["2012-12-24", 3.32], ["2012-12-25", 3.32], ["2012-12-26", 3.32], ["2012-12-27", 3.33], ["2012-12-28", 3.23], ["2012-12-31", 3.14]], 
			'caixabank': [["2012-01-02", 3.88], ["2012-01-03", 3.82], ["2012-01-04", 3.87], ["2012-01-05", 3.75], ["2012-01-06", 3.76], ["2012-01-09", 3.79], ["2012-01-10", 3.77], ["2012-01-11", 3.74], ["2012-01-12", 3.75], ["2012-01-13", 3.84], ["2012-01-16", 3.8], ["2012-01-17", 3.79], ["2012-01-18", 3.78], ["2012-01-19", 3.91], ["2012-01-20", 3.91], ["2012-01-23", 3.94], ["2012-01-24", 4.0], ["2012-01-25", 3.97], ["2012-01-26", 3.98], ["2012-01-27", 3.91], ["2012-01-30", 3.85], ["2012-01-31", 3.84], ["2012-02-01", 3.98], ["2012-02-02", 3.97], ["2012-02-03", 3.97], ["2012-02-06", 3.95], ["2012-02-07", 3.94], ["2012-02-08", 4.0], ["2012-02-09", 4.07], ["2012-02-10", 4.05], ["2012-02-13", 4.1], ["2012-02-14", 4.01], ["2012-02-15", 3.99], ["2012-02-16", 3.74], ["2012-02-17", 3.76], ["2012-02-20", 3.86], ["2012-02-21", 3.82], ["2012-02-22", 3.68], ["2012-02-23", 3.6], ["2012-02-24", 3.6], ["2012-02-27", 3.61], ["2012-02-28", 3.54], ["2012-02-29", 3.54], ["2012-03-01", 3.56], ["2012-03-02", 3.53], ["2012-03-05", 3.48], ["2012-03-06", 3.27], ["2012-03-07", 3.25], ["2012-03-08", 3.31], ["2012-03-09", 3.3], ["2012-03-12", 3.26], ["2012-03-13", 3.33], ["2012-03-14", 3.3], ["2012-03-15", 3.36], ["2012-03-16", 3.34], ["2012-03-19", 3.34], ["2012-03-20", 3.31], ["2012-03-21", 3.24], ["2012-03-22", 3.17], ["2012-03-23", 3.14], ["2012-03-26", 3.14], ["2012-03-27", 3.01], ["2012-03-28", 2.91], ["2012-03-29", 2.9], ["2012-03-30", 2.92], ["2012-04-02", 2.9], ["2012-04-03", 2.82], ["2012-04-04", 2.75], ["2012-04-05", 2.7], ["2012-04-06", 2.7], ["2012-04-09", 2.7], ["2012-04-10", 2.58], ["2012-04-11", 2.68], ["2012-04-12", 2.67], ["2012-04-13", 2.62], ["2012-04-16", 2.59], ["2012-04-17", 2.7], ["2012-04-18", 2.6], ["2012-04-19", 2.55], ["2012-04-20", 2.55], ["2012-04-23", 2.53], ["2012-04-24", 2.52], ["2012-04-25", 2.59], ["2012-04-26", 2.55], ["2012-04-27", 2.59], ["2012-04-30", 2.6], ["2012-05-01", 2.6], ["2012-05-02", 2.52], ["2012-05-03", 2.47], ["2012-05-04", 2.49], ["2012-05-07", 2.56], ["2012-05-08", 2.59], ["2012-05-09", 2.41], ["2012-05-10", 2.47], ["2012-05-11", 2.45], ["2012-05-14", 2.35], ["2012-05-15", 2.29], ["2012-05-16", 2.27], ["2012-05-17", 2.2], ["2012-05-18", 2.25], ["2012-05-21", 2.24], ["2012-05-22", 2.31], ["2012-05-23", 2.27], ["2012-05-24", 2.29], ["2012-05-25", 2.28], ["2012-05-28", 2.16], ["2012-05-29", 2.11], ["2012-05-30", 2.08], ["2012-05-31", 2.02], ["2012-06-01", 2.05], ["2012-06-04", 2.12], ["2012-06-05", 2.17], ["2012-06-06", 2.25], ["2012-06-07", 2.3], ["2012-06-08", 2.35], ["2012-06-11", 2.36], ["2012-06-12", 2.34], ["2012-06-13", 2.38], ["2012-06-14", 2.42], ["2012-06-15", 2.41], ["2012-06-18", 2.36], ["2012-06-19", 2.44], ["2012-06-20", 2.45], ["2012-06-21", 2.46], ["2012-06-22", 2.58], ["2012-06-25", 2.48], ["2012-06-26", 2.34], ["2012-06-27", 2.43], ["2012-06-28", 2.45], ["2012-06-29", 2.56], ["2012-07-02", 2.6], ["2012-07-03", 2.59], ["2012-07-04", 2.64], ["2012-07-05", 2.55], ["2012-07-06", 2.44], ["2012-07-09", 2.43], ["2012-07-10", 2.45], ["2012-07-11", 2.45], ["2012-07-12", 2.42], ["2012-07-13", 2.4], ["2012-07-16", 2.33], ["2012-07-17", 2.27], ["2012-07-18", 2.29], ["2012-07-19", 2.3], ["2012-07-20", 2.22], ["2012-07-23", 2.31], ["2012-07-24", 2.36], ["2012-07-25", 2.37], ["2012-07-26", 2.55], ["2012-07-27", 2.59], ["2012-07-30", 2.68], ["2012-07-31", 2.66], ["2012-08-01", 2.72], ["2012-08-02", 2.54], ["2012-08-03", 2.67], ["2012-08-06", 2.59], ["2012-08-07", 2.63], ["2012-08-08", 2.62], ["2012-08-09", 2.61], ["2012-08-10", 2.64], ["2012-08-13", 2.65], ["2012-08-14", 2.66], ["2012-08-15", 2.67], ["2012-08-16", 2.88], ["2012-08-17", 3.0], ["2012-08-20", 2.92], ["2012-08-21", 2.98], ["2012-08-22", 2.95], ["2012-08-23", 2.97], ["2012-08-24", 3.02], ["2012-08-27", 3.03], ["2012-08-28", 2.99], ["2012-08-29", 2.95], ["2012-08-30", 2.91], ["2012-08-31", 3.03], ["2012-09-03", 2.95], ["2012-09-04", 2.94], ["2012-09-05", 2.91], ["2012-09-06", 3.02], ["2012-09-07", 2.99], ["2012-09-10", 3.0], ["2012-09-11", 2.97], ["2012-09-12", 2.97], ["2012-09-13", 2.94], ["2012-09-14", 3.04], ["2012-09-17", 3.0], ["2012-09-18", 3.05], ["2012-09-19", 3.01], ["2012-09-20", 2.97], ["2012-09-21", 2.97], ["2012-09-24", 2.96], ["2012-09-25", 3.03], ["2012-09-26", 2.9], ["2012-09-27", 2.97], ["2012-09-28", 2.93], ["2012-10-01", 3.02], ["2012-10-02", 3.05], ["2012-10-03", 3.03], ["2012-10-04", 3.01], ["2012-10-05", 3.03], ["2012-10-08", 3.01], ["2012-10-09", 2.95], ["2012-10-10", 2.99], ["2012-10-11", 3.01], ["2012-10-12", 2.95], ["2012-10-15", 2.96], ["2012-10-16", 3.02], ["2012-10-17", 3.05], ["2012-10-18", 3.03], ["2012-10-19", 2.94], ["2012-10-22", 2.95], ["2012-10-23", 2.93], ["2012-10-24", 2.95], ["2012-10-25", 2.91], ["2012-10-26", 2.93], ["2012-10-29", 2.93], ["2012-10-30", 2.95], ["2012-10-31", 2.92], ["2012-11-01", 2.93], ["2012-11-02", 2.93], ["2012-11-05", 2.91], ["2012-11-06", 2.9], ["2012-11-07", 2.8], ["2012-11-08", 2.72], ["2012-11-09", 2.69], ["2012-11-12", 2.64], ["2012-11-13", 2.62], ["2012-11-14", 2.62], ["2012-11-15", 2.65], ["2012-11-16", 2.59], ["2012-11-19", 2.68], ["2012-11-20", 2.7], ["2012-11-21", 2.71], ["2012-11-22", 2.76], ["2012-11-23", 2.77], ["2012-11-26", 2.78], ["2012-11-27", 2.79], ["2012-11-28", 2.83], ["2012-11-29", 2.93], ["2012-11-30", 2.94], ["2012-12-03", 2.85], ["2012-12-04", 2.85], ["2012-12-05", 2.83], ["2012-12-06", 2.77], ["2012-12-07", 2.7], ["2012-12-10", 2.65], ["2012-12-11", 2.67], ["2012-12-12", 2.66], ["2012-12-13", 2.68], ["2012-12-14", 2.63], ["2012-12-17", 2.62], ["2012-12-18", 2.64], ["2012-12-19", 2.65], ["2012-12-20", 2.67], ["2012-12-21", 2.67], ["2012-12-24", 2.63], ["2012-12-25", 2.63], ["2012-12-26", 2.63], ["2012-12-27", 2.61], ["2012-12-28", 2.53], ["2012-12-31", 2.64]], 
			'bbva': [["2012-01-02", 6.8], ["2012-01-03", 6.84], ["2012-01-04", 6.63], ["2012-01-05", 6.3], ["2012-01-06", 6.23], ["2012-01-09", 6.06], ["2012-01-10", 6.28], ["2012-01-11", 6.28], ["2012-01-12", 6.33], ["2012-01-13", 6.4], ["2012-01-16", 6.44], ["2012-01-17", 6.53], ["2012-01-18", 6.44], ["2012-01-19", 6.75], ["2012-01-20", 6.76], ["2012-01-23", 6.85], ["2012-01-24", 6.83], ["2012-01-25", 6.8], ["2012-01-26", 6.97], ["2012-01-27", 6.9], ["2012-01-30", 6.74], ["2012-01-31", 6.67], ["2012-02-01", 6.89], ["2012-02-02", 7.05], ["2012-02-03", 7.19], ["2012-02-06", 7.22], ["2012-02-07", 7.26], ["2012-02-08", 7.22], ["2012-02-09", 7.3], ["2012-02-10", 7.14], ["2012-02-13", 7.14], ["2012-02-14", 7.12], ["2012-02-15", 7.09], ["2012-02-16", 6.8], ["2012-02-17", 6.9], ["2012-02-20", 7.1], ["2012-02-21", 7.07], ["2012-02-22", 6.89], ["2012-02-23", 6.77], ["2012-02-24", 6.77], ["2012-02-27", 6.76], ["2012-02-28", 6.75], ["2012-02-29", 6.73], ["2012-03-01", 6.81], ["2012-03-02", 6.81], ["2012-03-05", 6.69], ["2012-03-06", 6.33], ["2012-03-07", 6.3], ["2012-03-08", 6.52], ["2012-03-09", 6.46], ["2012-03-12", 6.3], ["2012-03-13", 6.49], ["2012-03-14", 6.5], ["2012-03-15", 6.55], ["2012-03-16", 6.66], ["2012-03-19", 6.75], ["2012-03-20", 6.68], ["2012-03-21", 6.49], ["2012-03-22", 6.31], ["2012-03-23", 6.24], ["2012-03-26", 6.15], ["2012-03-27", 6.06], ["2012-03-28", 5.93], ["2012-03-29", 5.86], ["2012-03-30", 5.97], ["2012-04-02", 5.97], ["2012-04-03", 5.7], ["2012-04-04", 5.61], ["2012-04-05", 5.6], ["2012-04-06", 5.6], ["2012-04-09", 5.6], ["2012-04-10", 5.4], ["2012-04-11", 5.6], ["2012-04-12", 5.5], ["2012-04-13", 5.33], ["2012-04-16", 5.15], ["2012-04-17", 5.35], ["2012-04-18", 5.18], ["2012-04-19", 4.95], ["2012-04-20", 5.1], ["2012-04-23", 5.0], ["2012-04-24", 5.15], ["2012-04-25", 5.26], ["2012-04-26", 5.15], ["2012-04-27", 5.22], ["2012-04-30", 5.11], ["2012-05-01", 5.11], ["2012-05-02", 4.94], ["2012-05-03", 4.88], ["2012-05-04", 5.03], ["2012-05-07", 5.3], ["2012-05-08", 5.26], ["2012-05-09", 5.01], ["2012-05-10", 5.31], ["2012-05-11", 5.24], ["2012-05-14", 5.05], ["2012-05-15", 4.92], ["2012-05-16", 4.9], ["2012-05-17", 4.77], ["2012-05-18", 4.94], ["2012-05-21", 4.89], ["2012-05-22", 5.01], ["2012-05-23", 4.81], ["2012-05-24", 4.93], ["2012-05-25", 4.93], ["2012-05-28", 4.76], ["2012-05-29", 4.64], ["2012-05-30", 4.57], ["2012-05-31", 4.6], ["2012-06-01", 4.66], ["2012-06-04", 4.85], ["2012-06-05", 4.88], ["2012-06-06", 5.04], ["2012-06-07", 5.1], ["2012-06-08", 5.15], ["2012-06-11", 5.15], ["2012-06-12", 5.14], ["2012-06-13", 5.21], ["2012-06-14", 5.26], ["2012-06-15", 5.25], ["2012-06-18", 5.03], ["2012-06-19", 5.16], ["2012-06-20", 5.34], ["2012-06-21", 5.31], ["2012-06-22", 5.36], ["2012-06-25", 5.07], ["2012-06-26", 4.98], ["2012-06-27", 5.09], ["2012-06-28", 5.16], ["2012-06-29", 5.63], ["2012-07-02", 5.64], ["2012-07-03", 5.79], ["2012-07-04", 5.73], ["2012-07-05", 5.46], ["2012-07-06", 5.18], ["2012-07-09", 5.11], ["2012-07-10", 5.05], ["2012-07-11", 5.17], ["2012-07-12", 5.04], ["2012-07-13", 5.08], ["2012-07-16", 4.92], ["2012-07-17", 4.95], ["2012-07-18", 4.96], ["2012-07-19", 5.0], ["2012-07-20", 4.61], ["2012-07-23", 4.62], ["2012-07-24", 4.43], ["2012-07-25", 4.43], ["2012-07-26", 4.91], ["2012-07-27", 5.15], ["2012-07-30", 5.37], ["2012-07-31", 5.32], ["2012-08-01", 5.28], ["2012-08-02", 4.94], ["2012-08-03", 5.35], ["2012-08-06", 5.59], ["2012-08-07", 5.74], ["2012-08-08", 5.72], ["2012-08-09", 5.66], ["2012-08-10", 5.64], ["2012-08-13", 5.66], ["2012-08-14", 5.72], ["2012-08-15", 5.74], ["2012-08-16", 5.96], ["2012-08-17", 6.04], ["2012-08-20", 5.91], ["2012-08-21", 5.98], ["2012-08-22", 5.81], ["2012-08-23", 5.71], ["2012-08-24", 5.73], ["2012-08-27", 5.84], ["2012-08-28", 5.82], ["2012-08-29", 5.84], ["2012-08-30", 5.76], ["2012-08-31", 6.07], ["2012-09-03", 6.08], ["2012-09-04", 6.06], ["2012-09-05", 6.07], ["2012-09-06", 6.39], ["2012-09-07", 6.51], ["2012-09-10", 6.49], ["2012-09-11", 6.57], ["2012-09-12", 6.63], ["2012-09-13", 6.51], ["2012-09-14", 6.68], ["2012-09-17", 6.67], ["2012-09-18", 6.48], ["2012-09-19", 6.45], ["2012-09-20", 6.32], ["2012-09-21", 6.55], ["2012-09-24", 6.47], ["2012-09-25", 6.52], ["2012-09-26", 6.2], ["2012-09-27", 6.23], ["2012-09-28", 6.11], ["2012-10-01", 6.08], ["2012-10-02", 6.14], ["2012-10-03", 6.06], ["2012-10-04", 6.02], ["2012-10-05", 6.22], ["2012-10-08", 6.16], ["2012-10-09", 6.02], ["2012-10-10", 5.92], ["2012-10-11", 6.02], ["2012-10-12", 5.93], ["2012-10-15", 5.96], ["2012-10-16", 6.31], ["2012-10-17", 6.66], ["2012-10-18", 6.65], ["2012-10-19", 6.45], ["2012-10-22", 6.39], ["2012-10-23", 6.29], ["2012-10-24", 6.3], ["2012-10-25", 6.25], ["2012-10-26", 6.28], ["2012-10-29", 6.23], ["2012-10-30", 6.32], ["2012-10-31", 6.44], ["2012-11-01", 6.45], ["2012-11-02", 6.5], ["2012-11-05", 6.33], ["2012-11-06", 6.33], ["2012-11-07", 6.09], ["2012-11-08", 6.09], ["2012-11-09", 6.09], ["2012-11-12", 6.02], ["2012-11-13", 6.23], ["2012-11-14", 6.24], ["2012-11-15", 6.27], ["2012-11-16", 6.11], ["2012-11-19", 6.28], ["2012-11-20", 6.3], ["2012-11-21", 6.36], ["2012-11-22", 6.43], ["2012-11-23", 6.46], ["2012-11-26", 6.42], ["2012-11-27", 6.41], ["2012-11-28", 6.35], ["2012-11-29", 6.55], ["2012-11-30", 6.52], ["2012-12-03", 6.5], ["2012-12-04", 6.55], ["2012-12-05", 6.59], ["2012-12-06", 6.63], ["2012-12-07", 6.57], ["2012-12-10", 6.51], ["2012-12-11", 6.62], ["2012-12-12", 6.7], ["2012-12-13", 6.75], ["2012-12-14", 6.8], ["2012-12-17", 6.83], ["2012-12-18", 6.89], ["2012-12-19", 6.99], ["2012-12-20", 7.0], ["2012-12-21", 7.03], ["2012-12-24", 7.02], ["2012-12-25", 7.02], ["2012-12-26", 7.02], ["2012-12-27", 7.04], ["2012-12-28", 6.92], ["2012-12-31", 6.96]],
			'sabadell': [["2012-01-02", 2.83], ["2012-01-03", 2.83], ["2012-01-04", 2.76], ["2012-01-05", 2.61], ["2012-01-06", 2.57], ["2012-01-09", 2.56], ["2012-01-10", 2.56], ["2012-01-11", 2.55], ["2012-01-12", 2.57], ["2012-01-13", 2.52], ["2012-01-16", 2.49], ["2012-01-17", 2.47], ["2012-01-18", 2.52], ["2012-01-19", 2.66], ["2012-01-20", 2.68], ["2012-01-23", 2.79], ["2012-01-24", 2.81], ["2012-01-25", 2.8], ["2012-01-26", 2.8], ["2012-01-27", 2.75], ["2012-01-30", 2.67], ["2012-01-31", 2.69], ["2012-02-01", 2.75], ["2012-02-02", 2.76], ["2012-02-03", 2.76], ["2012-02-06", 2.77], ["2012-02-07", 2.77], ["2012-02-08", 2.76], ["2012-02-09", 2.76], ["2012-02-10", 2.72], ["2012-02-13", 2.7], ["2012-02-14", 2.65], ["2012-02-15", 2.64], ["2012-02-16", 2.48], ["2012-02-17", 2.47], ["2012-02-20", 2.47], ["2012-02-21", 2.44], ["2012-02-22", 2.36], ["2012-02-23", 2.3], ["2012-02-24", 2.3], ["2012-02-27", 2.32], ["2012-02-28", 2.24], ["2012-02-29", 2.32], ["2012-03-01", 2.03], ["2012-03-02", 2.02], ["2012-03-05", 1.96], ["2012-03-06", 1.92], ["2012-03-07", 1.91], ["2012-03-08", 1.93], ["2012-03-09", 2.05], ["2012-03-12", 2.21], ["2012-03-13", 2.28], ["2012-03-14", 2.38], ["2012-03-15", 2.23], ["2012-03-16", 2.23], ["2012-03-19", 2.23], ["2012-03-20", 2.24], ["2012-03-21", 2.21], ["2012-03-22", 2.16], ["2012-03-23", 2.14], ["2012-03-26", 2.05], ["2012-03-27", 2.02], ["2012-03-28", 1.96], ["2012-03-29", 1.94], ["2012-03-30", 1.95], ["2012-04-02", 1.95], ["2012-04-03", 1.91], ["2012-04-04", 1.86], ["2012-04-05", 1.86], ["2012-04-06", 1.86], ["2012-04-09", 1.86], ["2012-04-10", 1.8], ["2012-04-11", 1.81], ["2012-04-12", 1.82], ["2012-04-13", 1.75], ["2012-04-16", 1.72], ["2012-04-17", 1.76], ["2012-04-18", 1.72], ["2012-04-19", 1.7], ["2012-04-20", 1.7], ["2012-04-23", 1.66], ["2012-04-24", 1.68], ["2012-04-25", 1.7], ["2012-04-26", 1.69], ["2012-04-27", 1.73], ["2012-04-30", 1.7], ["2012-05-01", 1.7], ["2012-05-02", 1.63], ["2012-05-03", 1.6], ["2012-05-04", 1.6], ["2012-05-07", 1.6], ["2012-05-08", 1.61], ["2012-05-09", 1.53], ["2012-05-10", 1.56], ["2012-05-11", 1.55], ["2012-05-14", 1.5], ["2012-05-15", 1.48], ["2012-05-16", 1.48], ["2012-05-17", 1.44], ["2012-05-18", 1.44], ["2012-05-21", 1.43], ["2012-05-22", 1.44], ["2012-05-23", 1.41], ["2012-05-24", 1.41], ["2012-05-25", 1.41], ["2012-05-28", 1.33], ["2012-05-29", 1.28], ["2012-05-30", 1.27], ["2012-05-31", 1.26], ["2012-06-01", 1.26], ["2012-06-04", 1.28], ["2012-06-05", 1.3], ["2012-06-06", 1.33], ["2012-06-07", 1.35], ["2012-06-08", 1.35], ["2012-06-11", 1.36], ["2012-06-12", 1.35], ["2012-06-13", 1.36], ["2012-06-14", 1.39], ["2012-06-15", 1.4], ["2012-06-18", 1.39], ["2012-06-19", 1.39], ["2012-06-20", 1.42], ["2012-06-21", 1.48], ["2012-06-22", 1.61], ["2012-06-25", 1.56], ["2012-06-26", 1.48], ["2012-06-27", 1.5], ["2012-06-28", 1.47], ["2012-06-29", 1.51], ["2012-07-02", 1.52], ["2012-07-03", 1.52], ["2012-07-04", 1.52], ["2012-07-05", 1.48], ["2012-07-06", 1.43], ["2012-07-09", 1.42], ["2012-07-10", 1.42], ["2012-07-11", 1.43], ["2012-07-12", 1.4], ["2012-07-13", 1.39], ["2012-07-16", 1.36], ["2012-07-17", 1.36], ["2012-07-18", 1.33], ["2012-07-19", 1.33], ["2012-07-20", 1.24], ["2012-07-23", 1.28], ["2012-07-24", 1.32], ["2012-07-25", 1.37], ["2012-07-26", 1.49], ["2012-07-27", 1.52], ["2012-07-30", 1.55], ["2012-07-31", 1.53], ["2012-08-01", 1.52], ["2012-08-02", 1.41], ["2012-08-03", 1.46], ["2012-08-06", 1.54], ["2012-08-07", 1.54], ["2012-08-08", 1.54], ["2012-08-09", 1.54], ["2012-08-10", 1.59], ["2012-08-13", 1.57], ["2012-08-14", 1.57], ["2012-08-15", 1.58], ["2012-08-16", 1.65], ["2012-08-17", 1.77], ["2012-08-20", 1.8], ["2012-08-21", 1.83], ["2012-08-22", 1.81], ["2012-08-23", 1.82], ["2012-08-24", 2.06], ["2012-08-27", 2.09], ["2012-08-28", 2.07], ["2012-08-29", 2.12], ["2012-08-30", 2.06], ["2012-08-31", 2.27], ["2012-09-03", 2.16], ["2012-09-04", 2.12], ["2012-09-05", 2.07], ["2012-09-06", 2.22], ["2012-09-07", 2.12], ["2012-09-10", 2.1], ["2012-09-11", 2.17], ["2012-09-12", 2.18], ["2012-09-13", 2.16], ["2012-09-14", 2.22], ["2012-09-17", 2.16], ["2012-09-18", 2.18], ["2012-09-19", 2.17], ["2012-09-20", 2.15], ["2012-09-21", 2.22], ["2012-09-24", 2.17], ["2012-09-25", 2.15], ["2012-09-26", 2.07], ["2012-09-27", 2.04], ["2012-09-28", 2.06], ["2012-10-01", 2.09], ["2012-10-02", 2.11], ["2012-10-03", 2.06], ["2012-10-04", 2.07], ["2012-10-05", 2.06], ["2012-10-08", 2.05], ["2012-10-09", 2.01], ["2012-10-10", 1.95], ["2012-10-11", 1.94], ["2012-10-12", 1.93], ["2012-10-15", 1.93], ["2012-10-16", 2.01], ["2012-10-17", 2.06], ["2012-10-18", 2.02], ["2012-10-19", 1.94], ["2012-10-22", 1.92], ["2012-10-23", 1.89], ["2012-10-24", 1.89], ["2012-10-25", 1.88], ["2012-10-26", 1.86], ["2012-10-29", 1.84], ["2012-10-30", 1.84], ["2012-10-31", 1.85], ["2012-11-01", 1.86], ["2012-11-02", 1.89], ["2012-11-05", 1.9], ["2012-11-06", 1.89], ["2012-11-07", 1.87], ["2012-11-08", 1.83], ["2012-11-09", 1.81], ["2012-11-12", 1.77], ["2012-11-13", 1.78], ["2012-11-14", 1.77], ["2012-11-15", 1.79], ["2012-11-16", 1.75], ["2012-11-19", 1.79], ["2012-11-20", 1.8], ["2012-11-21", 1.81], ["2012-11-22", 1.85], ["2012-11-23", 1.95], ["2012-11-26", 1.98], ["2012-11-27", 2.0], ["2012-11-28", 2.01], ["2012-11-29", 2.13], ["2012-11-30", 2.12], ["2012-12-03", 2.09], ["2012-12-04", 2.07], ["2012-12-05", 2.12], ["2012-12-06", 2.15], ["2012-12-07", 2.15], ["2012-12-10", 2.12], ["2012-12-11", 2.15], ["2012-12-12", 2.17], ["2012-12-13", 2.2], ["2012-12-14", 2.14], ["2012-12-17", 2.12], ["2012-12-18", 2.14], ["2012-12-19", 2.19], ["2012-12-20", 2.17], ["2012-12-21", 2.12], ["2012-12-24", 2.1], ["2012-12-25", 2.1], ["2012-12-26", 2.1], ["2012-12-27", 2.05], ["2012-12-28", 1.99], ["2012-12-31", 1.95]],
			'tef': [["2012-01-02", 13.66], ["2012-01-03", 13.71], ["2012-01-04", 13.42], ["2012-01-05", 13.12], ["2012-01-06", 13.05], ["2012-01-09", 13.01], ["2012-01-10", 13.36], ["2012-01-11", 13.39], ["2012-01-12", 13.4], ["2012-01-13", 13.35], ["2012-01-16", 13.4], ["2012-01-17", 13.6], ["2012-01-18", 13.27], ["2012-01-19", 13.48], ["2012-01-20", 13.36], ["2012-01-23", 13.39], ["2012-01-24", 13.2], ["2012-01-25", 13.15], ["2012-01-26", 13.37], ["2012-01-27", 13.31], ["2012-01-30", 13.25], ["2012-01-31", 13.33], ["2012-02-01", 13.49], ["2012-02-02", 13.44], ["2012-02-03", 13.47], ["2012-02-06", 13.41], ["2012-02-07", 13.37], ["2012-02-08", 13.32], ["2012-02-09", 13.35], ["2012-02-10", 13.15], ["2012-02-13", 13.06], ["2012-02-14", 13.09], ["2012-02-15", 13.05], ["2012-02-16", 12.86], ["2012-02-17", 13.05], ["2012-02-20", 13.26], ["2012-02-21", 13.18], ["2012-02-22", 13.06], ["2012-02-23", 12.88], ["2012-02-24", 12.86], ["2012-02-27", 12.9], ["2012-02-28", 12.87], ["2012-02-29", 12.81], ["2012-03-01", 12.9], ["2012-03-02", 12.86], ["2012-03-05", 12.78], ["2012-03-06", 12.42], ["2012-03-07", 12.39], ["2012-03-08", 12.57], ["2012-03-09", 12.53], ["2012-03-12", 12.35], ["2012-03-13", 12.62], ["2012-03-14", 12.62], ["2012-03-15", 12.7], ["2012-03-16", 12.81], ["2012-03-19", 13.0], ["2012-03-20", 13.01], ["2012-03-21", 12.91], ["2012-03-22", 12.78], ["2012-03-23", 12.66], ["2012-03-26", 12.58], ["2012-03-27", 12.48], ["2012-03-28", 12.3], ["2012-03-29", 12.18], ["2012-03-30", 12.29], ["2012-04-02", 12.35], ["2012-04-03", 12.04], ["2012-04-04", 11.87], ["2012-04-05", 11.9], ["2012-04-10", 11.55], ["2012-04-11", 11.78], ["2012-04-12", 11.61], ["2012-04-13", 11.26], ["2012-04-16", 11.24], ["2012-04-17", 11.56], ["2012-04-18", 11.08], ["2012-04-19", 11.08], ["2012-04-20", 11.06], ["2012-04-23", 10.76], ["2012-04-24", 11.05], ["2012-04-25", 11.3], ["2012-04-26", 11.12], ["2012-04-27", 11.31], ["2012-04-30", 11.01], ["2012-05-01", 11.01], ["2012-05-02", 10.66], ["2012-05-03", 10.68], ["2012-05-04", 10.85], ["2012-05-07", 11.15], ["2012-05-08", 11.18], ["2012-05-09", 11.0], ["2012-05-10", 11.32], ["2012-05-11", 11.17], ["2012-05-14", 10.89], ["2012-05-15", 10.68], ["2012-05-16", 10.65], ["2012-05-17", 10.61], ["2012-05-18", 9.92], ["2012-05-21", 9.82], ["2012-05-22", 9.99], ["2012-05-23", 9.5], ["2012-05-24", 9.68], ["2012-05-25", 9.61], ["2012-05-28", 9.44], ["2012-05-29", 9.16], ["2012-05-30", 8.85], ["2012-05-31", 8.94], ["2012-06-01", 9.0], ["2012-06-04", 9.39], ["2012-06-05", 9.3], ["2012-06-06", 9.6], ["2012-06-07", 9.44], ["2012-06-08", 9.78], ["2012-06-11", 9.68], ["2012-06-12", 9.84], ["2012-06-13", 9.81], ["2012-06-14", 9.93], ["2012-06-15", 9.89], ["2012-06-18", 9.5], ["2012-06-19", 9.87], ["2012-06-20", 9.94], ["2012-06-21", 9.96], ["2012-06-22", 10.15], ["2012-06-25", 9.68], ["2012-06-26", 9.59], ["2012-06-27", 9.76], ["2012-06-28", 9.86], ["2012-06-29", 10.37], ["2012-07-02", 10.4], ["2012-07-03", 10.52], ["2012-07-04", 10.48], ["2012-07-05", 10.2], ["2012-07-06", 9.88], ["2012-07-09", 9.85], ["2012-07-10", 9.92], ["2012-07-11", 10.09], ["2012-07-12", 9.76], ["2012-07-13", 9.96], ["2012-07-16", 9.75], ["2012-07-17", 9.82], ["2012-07-18", 9.89], ["2012-07-19", 9.95], ["2012-07-20", 9.21], ["2012-07-23", 9.02], ["2012-07-24", 8.63], ["2012-07-25", 8.66], ["2012-07-26", 8.95], ["2012-07-27", 9.21], ["2012-07-30", 9.29], ["2012-07-31", 9.23], ["2012-08-01", 9.31], ["2012-08-02", 8.72], ["2012-08-03", 9.35], ["2012-08-06", 9.8], ["2012-08-07", 10.1], ["2012-08-08", 10.1], ["2012-08-09", 10.1], ["2012-08-10", 10.0], ["2012-08-13", 10.04], ["2012-08-14", 10.1], ["2012-08-15", 10.14], ["2012-08-16", 10.45], ["2012-08-17", 10.66], ["2012-08-20", 10.6], ["2012-08-21", 10.66], ["2012-08-22", 10.34], ["2012-08-23", 10.21], ["2012-08-24", 10.2], ["2012-08-27", 10.29], ["2012-08-28", 10.2], ["2012-08-29", 10.1], ["2012-08-30", 9.89], ["2012-08-31", 10.04], ["2012-09-03", 10.16], ["2012-09-04", 10.44], ["2012-09-05", 10.43], ["2012-09-06", 10.98], ["2012-09-07", 11.19], ["2012-09-10", 11.08], ["2012-09-11", 11.23], ["2012-09-12", 11.43], ["2012-09-13", 11.32], ["2012-09-14", 11.58], ["2012-09-17", 11.5], ["2012-09-18", 11.38], ["2012-09-19", 11.4], ["2012-09-20", 11.19], ["2012-09-21", 11.35], ["2012-09-24", 11.26], ["2012-09-25", 11.23], ["2012-09-26", 10.7], ["2012-09-27", 10.72], ["2012-09-28", 10.38], ["2012-10-01", 10.42], ["2012-10-02", 10.54], ["2012-10-03", 10.49], ["2012-10-04", 10.43], ["2012-10-05", 10.61], ["2012-10-08", 10.51], ["2012-10-09", 10.3], ["2012-10-10", 10.15], ["2012-10-11", 10.2], ["2012-10-12", 10.15], ["2012-10-15", 10.17], ["2012-10-16", 10.52], ["2012-10-17", 10.85], ["2012-10-18", 10.85], ["2012-10-19", 10.6], ["2012-10-22", 10.5], ["2012-10-23", 10.26], ["2012-10-24", 10.3], ["2012-10-25", 10.19], ["2012-10-26", 10.2], ["2012-10-29", 10.07], ["2012-10-30", 10.2], ["2012-10-31", 10.16], ["2012-11-01", 10.27], ["2012-11-02", 10.35], ["2012-11-05", 10.1], ["2012-11-06", 10.22], ["2012-11-07", 10.0], ["2012-11-08", 10.0], ["2012-11-09", 10.03], ["2012-11-12", 9.97], ["2012-11-13", 10.13], ["2012-11-14", 10.14], ["2012-11-15", 10.1], ["2012-11-16", 10.01], ["2012-11-19", 10.17], ["2012-11-20", 10.15], ["2012-11-21", 10.16], ["2012-11-22", 10.22], ["2012-11-23", 10.26], ["2012-11-26", 10.2], ["2012-11-27", 10.11], ["2012-11-28", 10.02], ["2012-11-29", 10.12], ["2012-11-30", 10.09], ["2012-12-03", 10.05], ["2012-12-04", 10.1], ["2012-12-05", 10.04], ["2012-12-06", 10.1], ["2012-12-07", 10.0], ["2012-12-10", 9.93], ["2012-12-11", 10.06], ["2012-12-12", 10.12], ["2012-12-13", 10.19], ["2012-12-14", 10.19], ["2012-12-17", 10.12], ["2012-12-18", 10.19], ["2012-12-19", 10.21], ["2012-12-20", 10.19], ["2012-12-21", 10.25], ["2012-12-24", 10.3], ["2012-12-25", 10.3], ["2012-12-26", 10.3], ["2012-12-27", 10.28], ["2012-12-28", 10.17], ["2012-12-31", 10.19]] 
		}

		auxObject = {}
		auxData = {}
		for (var i = 0; i < valoresSeleccionados.length; i++) {
			// console.warn(sentimentValue[valoresSeleccionados[i]])
			data = []
			historico = historicos[valoresSeleccionados[i]]
			// console.log(historico)

			for (var j = 0; j < historico.length; j++) {
				data[j] = new Object();
				data[j].price = historico[j][1]
				fecha = historico[j][0]
				// console.log(fecha)
				data[j].date = fecha
				if (sentimentValue[valoresSeleccionados[i]][fecha] == undefined) {
					data[j].sentiment = 0
				} else {
					data[j].sentiment = sentimentValue[valoresSeleccionados[i]][fecha]
				}
			}
			// console.log(valoresSeleccionados[i])
			auxData[valoresSeleccionados[i]] = data

			var margin = {top: 10, right: 40, bottom:40, left: 60},
				width = $('#'+id).width() - margin.left - margin.right,
				height = 200 - margin.top - margin.bottom;

			var parseDate = d3.time.format("%Y-%m-%d").parse;

			var x = d3.time.scale().range([0, width]),
				y = d3.scale.linear().range([height, 0]),
				y2 = d3.scale.linear().range([height, 0]);

			var xAxis = d3.svg.axis().scale(x).orient("bottom"),
				yAxis = d3.svg.axis().scale(y).orient("left"),
				yAxis2 = d3.svg.axis().scale(y2).orient("right");

			var line = d3.svg.line()
				.interpolate("basis")
				.x(function(d) { return x(d.date); })
				.y(function(d) { return y(d.price); })

			var line2 = d3.svg.line()
				// .interpolate("basis")
				.x(function(d) { return x(d.date); })
				.y(function(d) { return y2(d.sentiment); })

			var svg = d3.select('#'+id).append("svg")
				.attr("width", width + margin.left + margin.right)
				.attr("height", height + margin.top + margin.bottom);

			svg.append("text")
				.text(valoresSeleccionados[i])
				.attr("x", -height/2)
				.attr("y", 25)
				.attr("transform", "rotate(-90)")
				.attr("font-family", "sans-serif")
				.attr("font-size", "20px")
				.attr("text-anchor", "middle")
			
			svg.append("defs").append("clipPath")
				.attr("id", "clip")
				.append("rect")
				.attr("width", width)
				.attr("height", height);
		
			var focus = svg.append("g")
				.attr("transform", "translate(" + margin.left + "," + margin.top + ")");

			var sentiment = svg.append("g")
				.attr("transform", "translate(" + margin.left + "," + margin.top + ")");

			data.forEach(function(d) {
				d.date = parseDate(d.date);
				d.price = +d.price;
			});

			x.domain(d3.extent(data.map(function(d) { return d.date; })));
			y.domain([d3.min(data.map(function(d) { return d.price; })), d3.max(data.map(function(d) { return d.price; }))]);
			y2.domain([-1, 1]);

			focus.append("path")
				.datum(data)
				.attr("clip-path", "url(#clip)")
				.attr("stroke", "steelblue")
				.attr("stroke-width", 2)
				.attr("fill", "none")
				.attr("d", line);

			focus.append("g")
				.attr("class", "x axis")
				.attr("transform", "translate(0," + height + ")")
				.call(xAxis);

			focus.append("g")
				.attr("class", "y axis")
				.call(yAxis);

			sentiment.append("path")
				.datum(data)
				.attr("clip-path", "url(#clip)")
				.attr("stroke", "black")
				.attr("stroke-width", 2)
				.attr("fill", "none")
				.attr("d", line2);

			sentiment.append("g")
				.attr("class", "y axis")
				.attr("transform", "translate(" + width + ", 0)")
				.call(yAxis2);

			auxObject[valoresSeleccionados[i]] = {'focus': focus, 'sentiment': sentiment}

			if (i == valoresSeleccionados.length-1) {

				var x2 = d3.time.scale().range([0, width]);
				x2.domain(x.domain());

				var xAxis2 = d3.svg.axis().scale(x2).orient("bottom");
				
				var brush = d3.svg.brush()
					.x(x2)
					.on("brush", brushed);

				var area2 = d3.svg.area()
					.interpolate("monotone")
					.x(function(d) { return x2(d.date); })
					.y0(70)
					.y1(function(d) { return 0; });

				var context = d3.select('#'+id).append("svg")
					.attr("width", width + margin.left + margin.right)
					.attr("height", 50)
					.append("g")
					.attr("transform", "translate(" + margin.left + "," + margin.top + ")");

				context.append("rect")
					.attr("class", "grid-background")
					.attr("wdith", width)
					.attr("height", height);

				context.append("g")
					.attr("class", "x axis")
					.attr("transform", "translate(0," + 20 + ")")
					.call(xAxis2);

				context.append("g")
					.attr("class", "x brush")
					.call(brush)
					.selectAll("rect")
					.attr("y", -6)
					.attr("height", 20 + 6);

				function brushed() {
					x.domain(brush.empty() ? x2.domain() : brush.extent());

					for (var j = 0; j < valoresSeleccionados.length; j++) {
						valor = valoresSeleccionados[j]

						focus = auxObject[valor]['focus']
						sentiment = auxObject[valor]['sentiment']

						data = auxData[valoresSeleccionados[j]]
						y.domain([d3.min(data.map(function(d) { return d.price; })), d3.max(data.map(function(d) { return d.price; }))]);

						focus.select("path").attr("d", line);
						sentiment.select("path").attr("d", line2);
						focus.select(".x.axis").call(xAxis);
					}
				}
			}
		}
	}
};